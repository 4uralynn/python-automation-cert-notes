Crashing Programs
=================


Coming across a program that crashes unexpectedly we again go through the troubleshooting cycle.
  1. Gather Information
  2. Find the root cause
  3. Apply the correct fix

With many crashes there can be many situations which the programmers did not anticipate that
could be causing the problem, so we first need to **reduce the scope** of the issue.

**Check any log files** that may contain errors that point to the issue.

**Check the reliability** of the crash:
  1. Are you able to reproduce the crash on a different machine?
    - If not it is a problem with that specific machine, or installation.
  2. Do all instances of the specific command or function fail?
    - If not it could be an issue with specific configurations/specifications/data being input.
  3. Are other applications on the system/OS causing a crash?
    - If not it could be an issue with the installation.
  4. Try exchanging hardware parts, or putting the harddrive in a clean computer.
    - Try the **memtest86** tool, to test the health of RAM
    - Check disks for bad sections
  5. If the hardware seems ok, check drivers and OS. Perhaps clean-install the OS. 


**When the** ****application itself*** **is crashing**, we want to again check log files:
  + In **Linux**, look at logs in `/var/log/` or `\home\user_name\.xession-errors`(user session errors)
    - The `ls -lt` command/option sorts files according to date modified. Pipe to ` | head` will show the first 10. 
  + On **MacOS**, use the *Console app*
  + On **Windows**, use the *Event Viewer*. You can access specific logs by creating a *custom view*.

Most logs will have a ***date and time***, and you can look for an error message explaining what happened.
Sometimes the error message is cryptic, and we can search online to see what it might mean. We might find
*official documentation* or posts documenting similar problems.

**If the errors aren't useful, or don't exist**, we can enable ***debug logging***.
  + Enable from a setting in the application or from an argument flag, when calling the application

**If there are no logs or error messages to find at all**, we can use `strace` on Linux, so see what
system calls the process is making.
  + On **MacOS** the equivalent is `dtruss`, and on **Windows**, we would use *Process Moniter*

**We can check which programs and libraries were recently updated** in the system log. We can also **check**
**recent configuration changes** if changes are managed byt a ***configuration management system*** and/or
are stored in s ***version control sysem*** (like Git), you may be able to find the issue in the history
of commits.

## Creating the Reproduction Case

It is *valuable* to spend some time figuring the state that triggered the crash.
  + Overall system *environment*
  + Specific application *configuration*
  + *Inputs* to application
  + *Outputs* generated by the application
  + *Resources used* by the applicaion
  + *Services* the application communicates with

We want the reproduction case to be *as small as possible*. So it is often useful to start with a *clean slate*
and then *slowly put the pieces in place* until the crash triggers.
  + Could beging with **trying the application with default configurations** rather than the local ones.
  + May be better to begin with a **fresh install on a clean machine**.
    - A ***virtual machine*** works great for this.

**Even if we cannot figure out the crash**, having a compact reproction case is very useful in reporting to
the bug to the developer.

## Work-Arounds

If you cannot fix the program itself, **if the problem is a compatability issue with data inputs**, you can
write a ***wrapper script***, similar to a wrapper function, which will reoganize or reconstitute data
into correct formats.

**If the overall system environment is not working with the application**, you can check the developer's 
specs to see what OS or environment was intended. You can **change the environment**  by changing the OS
congfigurations, changing the OS itself, or running the application inside a **container** or **virtual**
**machine**.

We can deploy a ***watchdog*** script to *check whether a program is running, and restarts the program*
if it isn't. 

***Always*** report the bug to the application developers.


